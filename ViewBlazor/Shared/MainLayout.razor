@inherits LayoutComponentBase
@using ViewModel
@using ViewBlazor.Components.Tabs
@using System.ComponentModel
@implements IDisposable
@inject MainWindowViewModel MainWindowViewModel

<PageTitle>ViewBlazor</PageTitle>

<div class="page">
    <div class="sidebar">
        <NavMenu ViewModel="@MainWindowViewModel" />
    </div>

    <main>
        <TabBar ViewModel="@MainWindowViewModel" />

        <article class="content px-4">
            <TabContent ViewModel="@MainWindowViewModel" />
        </article>
    </main>
</div>

@code {
    protected override void OnInitialized()
    {
        MainWindowViewModel.PropertyChanged += OnViewModelPropertyChanged;
    }

    private void OnViewModelPropertyChanged(object? sender, PropertyChangedEventArgs e)
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        MainWindowViewModel.PropertyChanged -= OnViewModelPropertyChanged;
    }
}
